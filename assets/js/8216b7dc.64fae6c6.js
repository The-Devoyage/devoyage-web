"use strict";(self.webpackChunkdevoyage_web=self.webpackChunkdevoyage_web||[]).push([[2643],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),g=a,m=p["".concat(l,".").concat(g)]||p[g]||d[g]||o;return n?r.createElement(m,i(i({ref:t},u),{},{components:n})):r.createElement(m,i({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},7506:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const o={id:"triggered-content",title:"Triggered Content"},i=void 0,s={unversionedId:"usage/triggered-content",id:"usage/triggered-content",title:"Triggered Content",description:"HTML and Variables are stored on the Mailer Service, allowing you to reuse content.",source:"@site/mailer/03-usage/03-triggered-content.md",sourceDirName:"03-usage",slug:"/usage/triggered-content",permalink:"/mailer/usage/triggered-content",draft:!1,editUrl:"https://www.github.com/The-Devoyage/devoyage-web/blob/master/mailer/03-usage/03-triggered-content.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"triggered-content",title:"Triggered Content"},sidebar:"mailerSidebar",previous:{title:"Default Content",permalink:"/mailer/usage/default-content"},next:{title:"Contents and Layouts",permalink:"/mailer/usage/content-and-layouts"}},l={},c=[{value:"Create Content",id:"create-content",level:2},{value:"Send a post request from the external service.",id:"send-a-post-request-from-the-external-service",level:3},{value:"Pass Custom Variables To Triggered Content",id:"pass-custom-variables-to-triggered-content",level:3}],u={toc:c};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"HTML and Variables are stored on the Mailer Service, allowing you to reuse content."),(0,a.kt)("h2",{id:"create-content"},"Create Content"),(0,a.kt)("p",null,"Use the GraphQL Resolver, ",(0,a.kt)("inlineCode",{parentName:"p"},"createContent")," to create a new ",(0,a.kt)("inlineCode",{parentName:"p"},"content")," object. Each ",(0,a.kt)("inlineCode",{parentName:"p"},"content")," is tied to a ",(0,a.kt)("inlineCode",{parentName:"p"},"trigger"),". This will save an HTML template to the connected mongo db instance that you can later reference by ",(0,a.kt)("inlineCode",{parentName:"p"},"trigger"),"."),(0,a.kt)("h3",{id:"send-a-post-request-from-the-external-service"},"Send a post request from the external service."),(0,a.kt)("p",null,"This time, use ",(0,a.kt)("inlineCode",{parentName:"p"},"triggeredContent")," and pass the ",(0,a.kt)("inlineCode",{parentName:"p"},"trigger")," name. Now, the server will use the HTML located on the Mailer Server instead of the HTML located within the external service. Shown below is the ",(0,a.kt)("inlineCode",{parentName:"p"},"@the-devoyage/mailer-connect")," method of posting the webhook. You may also use standard post request using the Node Fetch API or axios."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'// Accounts API\n// User successfully updates email.\n// Send POST Request to the mailer service to trigger email using @the-devoyage/mailer-connect library.\n\nmailer.send({\n  triggeredContent: {\n    to: updatedAccount.email,\n    trigger: "PASSWORD_RESET",\n  },\n  defaultContent: {\n    // The Default Content Arg is Required, as if the triggered content can not be found on the server, it will fall back to the default content.\n  },\n});\n')),(0,a.kt)("h3",{id:"pass-custom-variables-to-triggered-content"},"Pass Custom Variables To Triggered Content"),(0,a.kt)("p",null,"Pass variables to triggered content to send custom and dynamic information such as auth codes, names, and receipt information inside automated emails."),(0,a.kt)("p",null,"Example Content Pre-Made on the Mailer Server:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<body>\n  <p>Hello {{first_name}}! You have reset your password!</p>\n</body>\n")),(0,a.kt)("p",null,"Below, the triggered content accepts variables to generate the same dynamic content as the custom default content. The difference is, the triggered content is reusable while the default content needs to be written each time the request is called."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'// Accounts API\n// User successfully updates email.\n// Send POST Request to the mailer service to trigger email using @the-devoyage/mailer-connect library.\n\nconst varibales = { first_name: "nick" };\n\nmailer.send({\n  triggeredContent: {\n    to: updatedAccount.email,\n    trigger: "PASSWORD_RESET",\n    variables,\n  },\n  defaultContent: {\n    to: updatedAccount.email,\n    html: `<body><p>Hello ${variables.first_name}! You have reset your password!</p></body>`,\n    plainText: `Hello ${variables.first_name}! You have reset your password!`,\n    subject: "Password Reset",\n  },\n});\n')))}d.isMDXComponent=!0}}]);