"use strict";(self.webpackChunkdevoyage_web=self.webpackChunkdevoyage_web||[]).push([[9428],{3288:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var t=i(4848),r=i(8453);const s={id:"sql-migrations",title:"SQL Migrations"},o=void 0,a={id:"cli-options/sql-migrations",title:"SQL Migrations",description:"Subgraph supports some migration support using SQLX, a popular Rust Crate to manage SQL related tasks.",source:"@site/subgraph/09-cli-options/05-migrations.md",sourceDirName:"09-cli-options",slug:"/cli-options/sql-migrations",permalink:"/subgraph/cli-options/sql-migrations",draft:!1,unlisted:!1,editUrl:"https://www.github.com/The-Devoyage/devoyage-web/blob/master/subgraph/09-cli-options/05-migrations.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{id:"sql-migrations",title:"SQL Migrations"},sidebar:"subgraphSidebar",previous:{title:"Watching for Changes",permalink:"/subgraph/cli-options/watching-for-changes"},next:{title:"Auth Key Pair",permalink:"/subgraph/cli-options/auth-key-pair"}},l={},c=[{value:"Creating Migrations",id:"creating-migrations",level:2},{value:"Running Migrations",id:"running-migrations",level:2},{value:"Reverting Migrations",id:"reverting-migrations",level:2}];function g(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Subgraph supports some migration support using SQLX, a popular Rust Crate to manage SQL related tasks."}),"\n",(0,t.jsx)(n.h2,{id:"creating-migrations",children:"Creating Migrations"}),"\n",(0,t.jsx)(n.p,{children:"Use the SQLX Crate to create migrations. You currently need to install this on your own."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sqlx migrate add -r my-migration-name\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Provide a ",(0,t.jsx)(n.code,{children:".env"})," aside the migration folder to provide credentials to your database."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"# .env\n#For Migrations\nDATABASE_URL=sqlite:./todos.db\n"})}),"\n",(0,t.jsx)(n.h2,{id:"running-migrations",children:"Running Migrations"}),"\n",(0,t.jsx)(n.p,{children:"Running migrations can be done by providing a flag when starting the API."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"subgraph -c ./myconfig.toml --migrate run\n"})}),"\n",(0,t.jsx)(n.h2,{id:"reverting-migrations",children:"Reverting Migrations"}),"\n",(0,t.jsx)(n.p,{children:"You may use the SQLX Cli to revert a migration. This needs to be installed separately."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sqlx migrate revert\n"})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(g,{...e})}):g(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var t=i(6540);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);