"use strict";(self.webpackChunkdevoyage_web=self.webpackChunkdevoyage_web||[]).push([[4778],{5839:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>d,default:()=>c,frontMatter:()=>r,metadata:()=>a,toc:()=>u});var n=s(4848),i=s(8453);const r={id:"field-guards",title:"Field Guards"},d=void 0,a={id:"entities/fields/field-guards",title:"Field Guards",description:"Scoped Guards at the Field Level",source:"@site/subgraph/05-entities/02-fields/08-guards.md",sourceDirName:"05-entities/02-fields",slug:"/entities/fields/field-guards",permalink:"/subgraph/entities/fields/field-guards",draft:!1,unlisted:!1,editUrl:"https://www.github.com/The-Devoyage/devoyage-web/blob/master/subgraph/05-entities/02-fields/08-guards.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{id:"field-guards",title:"Field Guards"},sidebar:"subgraphSidebar",previous:{title:"Exclude From Output",permalink:"/subgraph/entities/fields/exclude-from-output"},next:{title:"Associations",permalink:"/subgraph/entities/fields/associations"}},o={},u=[{value:"Scoped Guards at the Field Level",id:"scoped-guards-at-the-field-level",level:2}];function l(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"scoped-guards-at-the-field-level",children:"Scoped Guards at the Field Level"}),"\n",(0,n.jsx)(t.p,{children:"Guards provide the capability to prevent access to the API based on custom conditions. Field guards\nallow scoped access based on if a client request is utilizing the guarded field."}),"\n",(0,n.jsx)(t.p,{children:"Applying a guard to a field can be done within the field configuration as shown below. Read more in the\nGuards section to learn about how guards work in terms of how to check conditions to guard the service."}),"\n",(0,n.jsxs)(t.p,{children:["The following guard on the ",(0,n.jsx)(t.code,{children:"password"})," property is only applied if the user includes the ",(0,n.jsx)(t.code,{children:"password"})," field\nwithin the selection set when performing queries or mutations, enabling guards to be applied conditionally\nbased on the fields the client requests."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-graphql",children:"# The password field guard will not be checked.\nquery GetUser($get_user_input: get_user_input!) {\n  get_user(get_user_input: $get_user_input) {\n    identifier\n  }\n}\n\n# Guards will be checked.\nquery GetUser($get_user_input: get_user_input!) {\n  get_user(get_user_input: $get_user_input) {\n    identifier\n    password # Providing this selection set enables the guard below.\n  }\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"Applying the Guard"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-toml",children:'[[entities]]\nname = "user"\nrequired = true\ndata_source = { from = "triceratask_ds", table = "subgraph_user" }\nfields = [\n  { name = "identifier", scalar = "String", required = true },\n  { name = "password", scalar = "String", exclude_from_input = ["All"], guards = [\n    { name = "Permissions Error", if_expr = "!every(input(\\"query\\", \\"uuid\\"), token_data(\\"user_uuid\\"))", then_msg = "You may not request pass keys that belong to other users." }\n  ] },\n]\n'})})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>d,x:()=>a});var n=s(6540);const i={},r=n.createContext(i);function d(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);